
 <!DOCTYPE HTML>
<html lang="zh-tw">
<head>

  <meta charset="UTF-8">
  
    <title>古典密碼學 | 雷德麥的藏書閣</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
    
    <meta name="author" content="Justin Yang">
    
    <meta name="description" content="古典密碼學已經被電腦打爆了，但這跟它重不重要一點關係都沒有。我的資安導師總是這樣嘮叨著……">
    
    
    
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/pacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/pacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">

    <link href='//fonts.googleapis.com/css?family=Gentium+Book Basic:700' rel='stylesheet' type='text/css'><script type="text/javascript">var _jf = _jf || [];_jf.push(['p','34799']);_jf.push(['_setFont','wcl-02','css','.wcl-02']);_jf.push(['_setFont','wcl-02','alias','wcl-02']);_jf.push(['_setFont','wcl-02','english','Gentium Book Basic']);_jf.push(['_setFont','wcl-02','weight',800]);_jf.push(['_setFont','sourcehansans-tc-regular','css','.sourcehansans-tc-regular']);_jf.push(['_setFont','sourcehansans-tc-regular','alias','sourcehansans-tc']);_jf.push(['_setFont','sourcehansans-tc-regular','weight',400]);(function(f,q,c,h,e,i,r,d){var k=f._jf;if(k.constructor===Object){return}var l,t=q.getElementsByTagName("html")[0],a=function(u){for(var v in k){if(k[v][0]==u){if(false===k[v][1].call(k)){break}}}},j=/\S+/g,o=/[\t\r\n\f]/g,b=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,g="".trim,s=g&&!g.call("\uFEFF\xA0")?function(u){return u==null?"":g.call(u)}:function(u){return u==null?"":(u+"").replace(b,"")},m=function(y){var w,z,v,u,x=typeof y==="string"&&y;if(x){w=(y||"").match(j)||[];z=t[c]?(" "+t[c]+" ").replace(o," "):" ";if(z){u=0;while((v=w[u++])){if(z.indexOf(" "+v+" ")<0){z+=v+" "}}t[c]=s(z)}}},p=function(y){var w,z,v,u,x=arguments.length===0||typeof y==="string"&&y;if(x){w=(y||"").match(j)||[];z=t[c]?(" "+t[c]+" ").replace(o," "):"";if(z){u=0;while((v=w[u++])){while(z.indexOf(" "+v+" ")>=0){z=z.replace(" "+v+" "," ")}}t[c]=y?s(z):""}}},n;k.push(["_eventActived",function(){p(h);m(e)}]);k.push(["_eventInactived",function(){p(h);m(i)}]);k.addScript=n=function(u,A,w,C,E,B){E=E||function(){};B=B||function(){};var x=q.createElement("script"),z=q.getElementsByTagName("script")[0],v,y=false,D=function(){x.src="";x.onerror=x.onload=x.onreadystatechange=null;x.parentNode.removeChild(x);x=null;a("_eventInactived");B()};if(C){v=setTimeout(function(){D()},C)}x.type=A||"text/javascript";x.async=w;x.onload=x.onreadystatechange=function(G,F){if(!y&&(!x.readyState||/loaded|complete/.test(x.readyState))){y=true;if(C){clearTimeout(v)}x.src="";x.onerror=x.onload=x.onreadystatechange=null;x.parentNode.removeChild(x);x=null;if(!F){setTimeout(function(){E()},200)}}};x.onerror=function(H,G,F){if(C){clearTimeout(v)}D();return true};x.src=u;z.parentNode.insertBefore(x,z)};a("_eventPreload");m(h);n(r,"text/javascript",false,3000)})(this,this.document,"className","jf-loading","jf-active","jf-inactive","//ds.justfont.com/js/stable/v/4.9.4/id/136909586106");</script>

</head>

  <body>
    <header>
      <div>
		
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="雷德麥的藏書閣">雷德麥的藏書閣</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜單">
			</a></div>
			<nav class="animated">
				<ul>
					
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/tags">Tags</a></li>
					
					<li>
					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="text" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:zake7749.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>

    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/08/05/classical_cipher/" title="古典密碼學" itemprop="url">古典密碼學</a>
  </h1>
  <p class="article-author">By
    
      <a href="https://plus.google.com/110210184472476270000?rel=author" title="Justin Yang" target="_blank" itemprop="author">Justin Yang</a>
    </p>
  <p class="article-time">
    <time datetime="2015-08-05T12:03:07.000Z" itemprop="datePublished">2015-08-05</time>
    更新日期:<time datetime="2015-08-09T02:59:29.000Z" itemprop="dateModified">2015-08-09</time>
    
  </p>
</header>
	<div class="article-content">
		
		
		<blockquote>
<p>古典密碼學已經被電腦打爆了，但這跟它重不重要一點關係都沒有。<br>我的資安導師總是這樣嘮叨著……</p>
</blockquote>
<a id="more"></a>
<p>最近重新改寫以前的<a href="http://sogacsie.blogspot.tw/" target="_blank" rel="external">Blog</a>，終於理解這句話的意涵。舉凡近代加密演算法，多為古典密碼學<strong>手段</strong>的組合，只不過以前人力與能力都不及。</p>
<p>比方說你不會想把16個字母放進一個矩陣中，每個查表代換10次，再每行平移幾個單位，然後各別乘上一個矩陣，最後再和別的矩陣做XOR邏輯判斷。</p>
<p><em>Welcome to modern cryptography</em></p>
<p>這也太累了！你不會想用紙筆來圈圈畫畫這些詭異的流程。不過單獨來看這些細項，就不會覺得那麼困難。諸如代換啦、矩陣運算、平移等等，這些都是古典密碼學各別的手段，透過熟悉它們，或許對當代算法的理解，像是強勢處與弱勢處也有所助益，甚至能激起新算法的開發靈感唷。</p>
<p>相較古文，追加了攻擊類型的紀錄，或許他不該包含於古典密碼學，但是對於初入資訊領域的生手而言，這應該會是相當重要的概念。</p>
<hr>
<h2 id="索引">索引</h2><h5 id="1-加密工具">1.加密工具</h5><ul>
<li>密碼棒</li>
<li>卡爾達諾漏格板</li>
<li>旋轉機</li>
<li>一次性密碼本</li>
</ul>
<h5 id="2-加密算法">2.加密算法</h5><ul>
<li>凱撒密碼</li>
<li>希爾密碼</li>
<li>路由加密</li>
<li>單字母替換密碼</li>
<li>維吉尼雅密碼</li>
</ul>
<h5 id="3-攻擊類型">3.攻擊類型</h5><ul>
<li>僅知密文攻擊</li>
<li>已知明文攻擊</li>
<li>選擇明文攻擊</li>
</ul>
<hr>
<h2 id="加密工具">加密工具</h2><hr>
<h5 id="1-密碼棒_(Scytale)">1.密碼棒 (Scytale)</h5><p><img src="https://3.bp.blogspot.com/-cIUNh6ALKzs/VGV1ikUgOKI/AAAAAAAAAL0/t2mG1J9F1qA/s320/scytale.gif" alt="skytale"></p>
<p>取布條將其纏繞於木棒上，橫向寫下明文後取下布條。解密時，必須取得相同直徑的木棒。</p>
<h5 id="2-卡爾達諾漏格板_(CardanGrille)">2.卡爾達諾漏格板 (CardanGrille)</h5><p><img src="http://3.bp.blogspot.com/-awX-BGDZDMM/VGYhoh_nnsI/AAAAAAAAAMc/vq9awjlikUQ/s1600/CardanGrille.png" alt="CardanGrille"></p>
<p>依照漏格書寫明文以及觀看明文。</p>
<h5 id="3-一次性密碼本">3.一次性密碼本</h5><p>使用亂數產生的一本加密用密碼本，可以把它想成一組金鑰，每當要產生明文時，將明文與密碼本的內容相加，如明文中的字母C (3)與密碼本的字母 X (25)，3+25=28，因為28超過了26個英文字母，而對28取餘數得2，即得加密完成的密文字母B。<br>一次性密碼本有三個限制：</p>
<ul>
<li>確定密碼本是由隨機產生的</li>
<li>密碼本必須只能使用一次</li>
<li>因為要與明文相加，密碼本至少要與明文一樣長</li>
</ul>
<h2 id="加密算法">加密算法</h2><hr>
<h5 id="1-凱撒密碼">1.凱撒密碼</h5><p>凱撒密碼出自羅馬軍事家<a href="https://zh.wikipedia.org/wiki/%E5%B0%A4%E5%88%A9%E7%83%8F%E6%96%AF%C2%B7%E5%87%B1%E6%92%92" target="_blank" rel="external">尤利烏斯·凱撒</a>，用在對戰爭與軍事信息的加密。</p>
<p>凱撒密碼的流程並不難，因為當時的敵人多是目不識丁的。</p>
<blockquote>
<p>已知明文字母P，引入一個參數K，得出密文 C = (P + K)mod 26</p>
</blockquote>
<p>例如 ABCDEFGHIJK，在K=3時，得出密文DEFGHIJKLMN。(K=3是最初的凱撒密碼)<br>解密時 P = (C - K)mod 26。</p>
<p>由於凱撒密碼只是對英文字母進行簡單的代換，我們可以透過分析各個字母出現的頻率推斷明文，比方說英文書寫上最常出現的字為 E ，我們便可以猜測密文中出現最多次數的英文字母是 E 的代換，藉此得出 P 與 C 的關係。</p>
<p>由於這個方法主要是觀察英文字母使用的頻率，故又稱為頻率分析法，對於簡單的字母代換，頻率分析往往是有效的手段。</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/4/41/English-slf.png" alt="FrequencyofAlphabet"></p>
<p>(“English-slf”。使用來自维基共享资源-的創用CC姓名標示-相同方式分享 3.0 條款授權)</p>
<p>也因其架構簡單，現今電腦已能用暴力法輕易破解，故只用於字謎類遊戲(ROT-13)。</p>
<h5 id="2-希爾密碼">2.希爾密碼</h5><p>使用矩陣進行加密，由密文構成的密文矩陣C = KP，其中P為明文構成的明文矩陣，K為密鑰矩陣，密鑰矩陣須為可逆才可供解密</p>
<p><img src="http://1.bp.blogspot.com/-CLC48A92h_w/VJFiTQvAhCI/AAAAAAAAAQk/XOSwXGlgeho/s1600/hILL%2BCIPHER.png" alt="HillCipher"></p>
<p>希爾加密避開了頻率分析攻擊，然而在已知明文的情況下，可透過逆運算求得金鑰，無法保證安全性。</p>
<h5 id="3-路由加密">3.路由加密</h5><p>近似於密碼棒，採用直書橫寫的方式進行加密。</p>
<h5 id="4-單字母替換密碼">4.單字母替換密碼</h5><p>與凱撒密碼同為單字母取代的概念。將26個英文字母分別做對應，比如A對應C，B對應F，替換不受限於特定規則，也不要求有跡可循，純粹是做出26個字母的明文密文對應表，以供加密與解密時使用。</p>
<p>儘管其複雜度遠遠高於凱撒密碼，但明文字母與密文字母仍屬一對一對應，同樣易受頻率分析攻擊破解。</p>
<h5 id="5-維吉尼雅密碼">5.維吉尼雅密碼</h5><p>維吉尼亞密碼主要是透過查表進行字母的轉換</p>
<p><img src="https://3.bp.blogspot.com/-DwYbQG7U6u0/VGWGDLIZM-I/AAAAAAAAAMM/tXsTlLvCw14/s400/300px-Vigene%CC%80re_square.svg.png" alt="維吉尼亞加密"></p>
<p>上圖其實是由26個凱撒密碼構成的。</p>
<ul>
<li>第一行為字母位移 0 位的凱撒密碼 ABCDEFG…(即原順序)</li>
<li>第二行為字母位移 1 位的凱撒密碼 BCDEFGH…</li>
<li>第三行為字母位移 2 位的凱撒密碼 CDEFGHI…</li>
<li>……以此類推</li>
</ul>
<p>維吉尼雅密碼首先引入了<strong>金鑰</strong>的概念，假設要加密ABCDEFG，使用密鑰CIP。首先，先將密鑰長度補至和明文一樣長，例如：</p>
<center>ＡＢＣＤＥＦＧ<br>ＣＩＰＣＩＰＣ</center>

<p>接下來，取第Ａ行第Ｃ列得Ａ(實際上就是雙重的凱撒密碼)，取第Ｂ行第Ｉ列得Ｊ…取第Ｇ行第Ｃ列得I，如此完成加密。</p>
<p>由於引入了金鑰這個變換要素，我們在明文上做了兩次變換，普通的頻率分析不適用在維吉尼亞密碼，只要確保金鑰不過度重複(如配合一次性密碼本)，維吉尼亞密碼是足夠安全的。</p>
<hr>
<h2 id="攻擊類型">攻擊類型</h2><hr>
<h5 id="1-僅知密文攻擊">1.僅知密文攻擊</h5><p>攻擊者在只知道密文的情況下試圖求得明文或金鑰。</p>
<h5 id="2-已知明文攻擊">2.已知明文攻擊</h5><p>攻擊者在知道部分明文與密文配對的情況下試圖破解。</p>
<h5 id="3-選擇明文攻擊">3.選擇明文攻擊</h5><p>公開加密器，攻擊者可以自由輸入明文及得到該明文的密文，藉此試圖破解算法。</p>
<p>儘管選擇明文攻擊攻防上看似不合理，<span style="color:#a9e74b"><strong>但在近代密碼學中，十分強調在公開演算法的情況下，還能保證安全的才是優秀的演算法。</strong></span></p>
<p>直觀來看，要做一個加密流程很容易，我們可以有很多把金鑰，再搭配各式各樣的函式打造自己的流程，反覆做個幾十次，甚至幾百次，這麼一來，除非流程與金鑰外洩，否則這個演算法理論上牢不可破。</p>
<p>但是換個立場，如果我們是使用者，今天開發者送來了一個加密器，他聲稱這個加密器速度不僅很快，還會透過好幾把金鑰，經歷幾十次字元變換後得出一份完美的密文。</p>
<p>這個加密器感覺上確實相當了不起，明文與密文也找不著對應。但是，如果它擁有一把萬用鑰匙呢？或是說這幾百道的換算能被規約成兩三條式子。對這些疑問，身為使用者的我們無法斷言，不過，開發者知道。</p>
<p>對於一個未公開加密法，算法的開發者或維護者可能就是最危險的攻擊者。</p>
<p>此外，不論有意無意，算法可能有開發上未發現的漏洞或暗門，透過公開演算內容，大眾能共同尋找設計上是否存在瑕疵，像是近代算法中的AES、A5/1，便透過各方人才的審核，不但確保了使用上了安全性，也建立出自己的好口碑。</p>
  
	</div>
		<footer class="article-footer clearfix">

  <div class="article-tags">
  
  <span></span> <a href="/tags/密碼學/">密碼學</a><a href="/tags/資訊安全/">資訊安全</a>
  </div>




<div class="article-share" id="share">

  <div data-url="http://zake7749.github.io/2015/08/05/classical_cipher/" data-title="古典密碼學 | 雷德麥的藏書閣" data-tsina="" class="share clearfix">
  </div>

</div>
</footer>   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2015/08/06/message_auth/" title="訊息鑑別技術">
  <strong>PREVIOUS:</strong><br/>
  <span>
  訊息鑑別技術</span>
</a>
</div>


</nav>

	
</div>  
      <div class="openaside"><a class="navbutton" href="#" title="顯示側邊欄"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隱藏側邊欄"></a></div>
<aside class="clearfix">

  

  
<div class="tagslist">
	<p class="asidetitle">標簽</p>
		<ul class="clearfix">
		
			<li><a href="/tags/密碼學/" title="密碼學">密碼學<sup>1</sup></a></li>
		
			<li><a href="/tags/訊息鑑別/" title="訊息鑑別">訊息鑑別<sup>1</sup></a></li>
		
			<li><a href="/tags/資訊安全/" title="資訊安全">資訊安全<sup>2</sup></a></li>
		
		</ul>
</div>


  
  <div class="tagcloudlist">
    <p class="asidetitle">標簽雲</p>
    <div class="tagcloudlist clearfix">
       <a href="/tags/密碼學/" style="font-size: 10px;">密碼學</a> <a href="/tags/訊息鑑別/" style="font-size: 10px;">訊息鑑別</a> <a href="/tags/資訊安全/" style="font-size: 20px;">資訊安全</a>
    </div>
  </div>


  
  <div class="archiveslist">
    <p class="asidetitle"><a href="/archives">歸檔</a></p>
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">八月 2015</a><span class="archive-list-count">2</span></li></ul>
  </div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> 熱衷於AI與遊戲設計的新手 <br/>
			目前在尋找一個大秘寶的旅途上</p>
	</section>
	 
	<div class="social-font clearfix">
		
		
		
		<a href="https://github.com/zake7749" target="_blank" title="github"></a>
		
		
		
        <a title="google_plus" href="https://plus.google.com/110210184472476277760/posts"></a>
	</div>
		<p class="copyright">Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and this theme is modified from <a href="https://github.com/A-limon/pacman" target="_blank" title="Pacman">Pacman</a> © 2015 
		
		<a href="http://zake7749.github.io" target="_blank" title="Justin Yang">Justin Yang</a>
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



  </body>
</html>
